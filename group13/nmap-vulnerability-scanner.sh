#!/bin/bash

# Title: Network Vulnerability Scanner
# Authors: Ríkharður Friðgeirsson & Emil Örn Kristjánsson

# Argument 1: The network range to scane on the CIDR format. Example, 192.168.1.0/24

# Requirements: The script requires you to be running a linux system and have nmap installed.

# Script was made for a network security course taught at Reykjavik University Iceland. Using this script can
# be considered illegal. This was only made as a proof of concept. 

# Running time can vary heavily on the results from the first TCP scan. When tested the TCP scan returned ~100 IPs
# that answered. Running the consecutive scans on ~100 IPs can take up to 24 hours. 

nmap -oN tcp_scan_results.txt $1 -sn -T4
grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' tcp_scan_results.txt >> targets.txt
nmap -iL targets.txt -oN aggressive_scan_results.txt -A -T2 
nmap -iL targets.txt -oN vulnerability_scan_results.txt --script vulners.nse -sV -T2 
